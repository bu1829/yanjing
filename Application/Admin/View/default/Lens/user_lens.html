<include file="Public:metas"/>
<style>
.single-picture-div{float:left;margin:10px}
.single-picture{width:80px;height:80px;}
#picture{margin-bottom:40px;}
#fileupload{width:80px;height:80px;margin-left:0px;position:absolute;top:10px;opacity:0;z-index:999;}
.delimg{position:relative;left:-60px;bottom:-55px;}
.expert-info{margin-bottom:15px;}
.expert-avatar{width:30px;height:30px;margin-right:10px;}
.expert-name{font-weight:bold;margin-right:10px;}
.delcomment{cursor:pointer;}

</style>
<!-- <link rel="stylesheet" href="__PUBLIC__/Home/css/goods_details.css"> -->
<script src="__PUBLIC__/Home/js/e-smart-zoom-jquery.min.js"></script>
<script>
 $(function() {
	 changeSort("goods_picture","id","sort");
	 //默认显示
	 
	 changeSort("goods_expert_comment","id","sort","sortable2");
	 //默认显示
 });
</script>

    <div>
        <div>
            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-10" id="biaoti">
                    <ol class="breadcrumb" style="margin-top:20px;">
                        <li>
                            	镜片管理
                        </li>
                        <li>
                            <strong><{$meta_title}></strong>
                        </li>
                    </ol>
                </div>
                <div class="col-lg-2" id="fubiaoti">
					<a href="<{:U('Lens/userList')}>" class="btn btn-xs btn-info">客户列表</a>
                </div>
            </div>
            <div class="wrapper wrapper-content animated fadeInRight white-bg">
                
                <div class="row">
                    
                    <div class="col-lg-12">
                    
                    	<div class="panel blank-panel">

                            <div class="panel-heading">
                                <div class="panel-options">

									<form id="signupForm5" action=""  method="post" class="form-horizontal m-t" enctype="multipart/form-data" onsubmit="return check()">
									<div class="tab-content">
										<div class="tab-pane active" id="basic">

									<if condition="$data eq null">
											<div class="form-group">
		                                        <label class="col-sm-2 control-label"><font class="text-danger">*</font> 是否为新用户：</label>
		                                        <div class="col-sm-3">
		                                         	<div class="radio radio-success" style="float:left;margin-right:10px;">
		                                                <input type="radio" name="is_new_user" id="is_new_user1" value="1"  class="newuser" checked="">
		                                                <label for="is_new_user1">
		                                                  	  是
		                                                </label>
		                                            </div>
		                                            
		                                            <div class="radio radio-danger" style="float:left;">
		                                                <input type="radio" name="is_new_user" id="is_new_user0" value="0"  class="olduser">
		                                                <label for="is_new_user0">
		                                               		   否
		                                                </label>
		                                            </div>
		                                        </div>
		                                    </div>

										<div class="new_user" style="display:show;">

		                                </div>
									</if>




										<div class="old_user" style="display:none;">
		                                	<div class="form-group">
		                                        <label class="col-sm-2 control-label"> 用户：</label>
		                                        <div class="col-sm-2">
		                                        	<button type="button" class="btn btn-sm btn-info choseuser">选择用户</button>
		                                        	
		                                        	<if condition="$artist neq null">
		                                        		<if condition="$artist.picture neq null">
			                                        	<img class="img-circle expert-avatar art" src="__ROOT__<{$artist.picture}>"/>
			                                        	</if>
			                                        	<font class="art" style="font-weight:bold;"><{$artist.name}> </font>
				                                        <i class="fa fa-close art"></i>
			                                        </if>
			                                        
			                                        <input type="hidden" name="user_id" value="<{$data.user_id}>"> 
		                                            
		                                        </div>
		                                    </div>
										</div>

		                                    

<div class="form-group">
	<center>
          <table width="80%" height="35%" border="1" cellpadding="0" cellspacing="0">
             <tr>
                 <th>姓名</th>
                 <td><input type="text" id="name" name="name" value="<{$data.name}>" 
                 style="border:none;outline:none;width:80px;height:40px;"></td>
                 <th>性别</th>
                 <td><input type="text" id="sex" name="sex" value="<{$data.sex}>"style="border:none;outline:none;width:80px;height:40px;"></td>
                 <th>地址</th>
                 <td colspan="2"><input type="text" id="address" name="address" value="<{$data.address}>" style="border:none;outline:none;width:240px;height:40px;"></td>
                 <th>电话</th>
                 <td><input type="text" id="mobile" name="mobile" value="<{$data.mobile}>" style="border:none;outline:none;width:160px;height:40px;"></td>
             </tr>
             <tr>
                 <th>年龄</th>
                 <td><input type="text" id="age" name="age" value="<{$data.age}>" style="border:none;outline:none;width:80px;height:40px;"></td>
                 <th>球镜</th>
                 <th>柱镜</th>
                 <th>轴位</th>
                 <th>矫正视力</th>
                 <td></td>
                 <td colspan="2"></td>
             </tr>
             <tr>
                 <th rowspan="2">远用</th>
                 <th>右</th>
                 <td><input type="text" name="f_r_ballmirror" value="<{$data.f_r_ballmirror}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="f_r_columnmirror" value="<{$data.f_r_columnmirror}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="f_r_shaftposition" value="<{$data.f_r_shaftposition}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="f_r_correcteyesight" value="<{$data.f_r_correcteyesight}>" style="border:none;outline:none;width:160px;height:30px;"></td>
                 <th>镜架</th>
                 <td colspan="2"><input type="text" name="gls_frame" value="<{$data.gls_frame}>" style="border:none;outline:none;width:300px;height:31px;"></td>
             </tr>
             <tr>
                 <th>左</th>
                 <td><input type="text" name="f_l_ballmirror" value="<{$data.f_l_ballmirror}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="f_l_columnmirror" value="<{$data.f_l_columnmirror}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="f_l_shaftposition" value="<{$data.f_l_shaftposition}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="f_l_correcteyesight" value="<{$data.f_l_correcteyesight}>" style="border:none;outline:none;width:160px;height:30px;"></td>
                 <th>镜片</th>
                 <td colspan="2"><input type="text" name="lens" value="<{$data.lens}>" style="border:none;outline:none;width:300px;height:31px;"></td>
             </tr>
             <tr>
                 <th rowspan="2">近用</th>
                 <th>右</th>
                 <td><input type="text" name="n_r_ballmirror" value="<{$data.n_r_ballmirror}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="n_r_columnmirror" value="<{$data.n_r_columnmirror}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="n_r_shaftposition" value="<{$data.n_r_shaftposition}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="n_r_correcteyesight" value="<{$data.n_r_correcteyesight}>" style="border:none;outline:none;width:160px;height:30px;"></td>
                 <th>瞳距</th>
                 <td><input type="text" name="pupil_distance" value="<{$data.pupil_distance}>" style="border:none;outline:none;width:80px;height:31px;">mm</td>
                 <th>金额</th>
             </tr>
             <tr>
                 <th>左</th>
                 <td><input type="text" name="n_l_ballmirror" value="<{$data.n_l_ballmirror}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="n_l_columnmirror" value="<{$data.n_l_columnmirror}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="n_l_shaftposition" value="<{$data.n_l_shaftposition}>" style="border:none;outline:none;width:80px;height:30px;"></td>
                 <td><input type="text" name="n_l_correcteyesight" value="<{$data.n_l_correcteyesight}>" style="border:none;outline:none;width:160px;height:30px;"></td>
                 <th>瞳高</th>
                 <td><input type="text" name="pupil_hight" value="<{$data.pupil_hight}>" style="border:none;outline:none;width:80px;height:31px;">mm</td>
                 <td><input type="text" name="total_price" value="<{$data.total_price}>" style="border:none;outline:none;width:80px;height:31px;"></td>
             </tr>
         </table>                                       
     </center>
</div>		                                    
											 

		                                    


		                                    <div style="margin-bottom:20px;">
								            	<label class="col-sm-2 control-label" style="margin-left:-10px;"><font class="text-danger">*</font> 配镜时间：</label>
								                <input name='gls_time' value='<{$data.gls_time}>' class="laydate-icon btn-sm btn-white" id="start"/ style="height:30px;margin-left:15px;">
												<script>
													laydate({
													    elem: '#start',
													    istime: false,
													    format: 'YYYY-MM-DD', // 分隔符可以任意定义，该例子表示只显示年月
													    festival: true, //显示节日
													    choose: function(datas){ //选择日期完毕的回调
													    }
													});
													laydate.skin("molv");
												</script>
		                                    
		                                    
										</div>
										
										
								 	<div class="form-group">
                                        <label class="col-sm-2 control-label"></label>
                                        <div class="col-sm-10">
                                        	<input  type="hidden" value="<{$data.id}>" name="id"/>
                                            <button class="btn btn-sm btn-primary" type="submit">保存</button>
                                          	<button class="btn btn-sm btn-warning" type="reset">重置</button>
                                        </div>
                                    </div>
                                    
		                                    
								 	</form>
                                </div>
                            </div>
                        </div>
	                </div>
	                
                </div>

            </div>
            <!--上传图片  -->
            <include file="Public:upload"/>
            <!--上传图片  -->
        </div>
    </div>

    <!-- 放置缩略图显示的 -->
    <div style="display:none;padding:0px;" class="open1">
	<img src="" alt="" class="fancybox-image carousel-inne img-rounded img-responsive openimg1"/>
	</div>

	<!-- 放置画籍证书显示的 -->
    <div style="display:none;padding:0px;" class="open2">
	<img src="" alt="" class="fancybox-image carousel-inne img-rounded img-responsive openimg2"/>
	</div>


	<script type="text/javascript" src="__CJS__/jquery.form.js"></script>
	<script type="text/javascript">
	function call_back_user(id,name,sex,address,mobile,age){//选客户片返回
		 $("[name='user_id']").val(id);
		 $(".user").remove();
		 $(".choseuser").after('<font class="user" style="font-weight:bold;color:red">'+name+' </font>');
		 $("#name").val(name);
		 $("#sex").val(sex);
		 $("#address").val(address);
		 $("#mobile").val(mobile);
		 $("#age").val(age);
		 reset();
		 layer.closeAll('iframe');
	}


	function call_back_lens_l(id,name){//选择镜片返回
		 $("[name='lens_l_id']").val(id);
		 $(".lens_l").remove();
		 $(".choselens_l").after('<font class="lens_l" style="font-weight:bold;color:red">'+name+' </font>');
		 reset();
		 layer.closeAll('iframe');
	}

	function call_back_lens_r(id,name){//选择镜片返回
		 $("[name='lens_r_id']").val(id);
		 $(".lens_r").remove();
		 $(".choselens_r").after('<font class="lens_r" style="font-weight:bold;color:red">'+name+' </font>');
		 reset();
		 layer.closeAll('iframe');
	}
	
	/*重置艺术家*/
	function reset(){
		$(".fa-close").click(function(){
			layer.confirm('确定删除吗？', {
				icon:7,btn: ['删除','取消'] //按钮
			}, function(){
				$("[name='artist_id']").val("");
	    		$(this).remove();
	    		$(".art").remove();
	    		$(".layui-layer-btn1").trigger("click");
			});
    	})
	}
	
	
	
	
	
	
    $().ready(function(){
    	 $("#is_new_user<{$data.is_new_user}>").prop("checked","checked");//状态
    	 $("#artist<{$data.arter_id}>").prop("selected","selected");//艺术家
    	 $("#goods_type<{$data.goods_type}>").prop("selected","selected");//商品类型
    	 $("#first<{$data.first_cate}>").prop("selected","selected");//商品一级分类
    	 $("#second<{$data.second_cate}>").prop("selected","selected");//商品二级分类
    	 $("#is_enquiry<{$data.is_enquiry}>").prop("checked","checked");
    	 
    	 //delComment();//删除评论
    	 reset();//重置艺术家
    	 
    	 var gid="<{$data.id}>";//商品id
    	 
    	 
    	//选择客户
    	$(".choseuser").click(function(){
    		layer.open({
    			  type: 2,
    			  title: '选择客户',
    			  shadeClose: true,
    			  shade: 0.8,
    			  area: ['80%', '90%'],
    			  content: '__APP__/Lens/userList/types/chose' //iframe的url
   			}); 
    	})
    	 
    	 
    	//选择左镜片
    	$(".choselens_l").click(function(){
    		layer.open({
    			  type: 2,
    			  title: '选择镜片',
    			  shadeClose: true,
    			  shade: 0.8,
    			  area: ['80%', '90%'],
    			  content: '__APP__/Lens/LensList/types/chose/lr/l' //iframe的url
   			}); 
    	})

    	//选择右镜片
    	$(".choselens_r").click(function(){
    		layer.open({
    			  type: 2,
    			  title: '选择镜片',
    			  shadeClose: true,
    			  shade: 0.8,
    			  area: ['80%', '90%'],
    			  content: '__APP__/Lens/LensList/types/chose/lr/r' //iframe的url
   			}); 
    	})
    	
    	 
    	 
    })


    $(".newuser").click(function(){
	        $(".new_user").show();
	        $(".old_user").hide();
	    })

	     $(".olduser").click(function(){
	        $(".old_user").show();
	        $(".new_user").hide();
	    })

	function check(){
		var is_new_user = $("[name='is_new_user']").val();
		var name=$("[name='name']").val();
		if(name==''){
			layer.msg("请填写客户姓名");
			$("[name='name']").focus();
			return false;
		}
		// var mobile=$("[name='mobile']").val();
		// if(name==''){
		// 	layer.msg("请填写正确的手机号码");
		// 	$("[name='mobile']").focus();
		// 	return false;
		// }

		var gls_time=$("[name='gls_time']").val();
		if(gls_time==''){
			layer.msg("请选择正确的配镜时间");
			$("[name='gls_time']").focus();
			return false;
		}

		return true;





		var gid="<{$data.id}>";//商品id
		
		// //商品名称
		// var name=$("[name='name']").val();
		// if(name==""){
		// 	layer.msg("请输入商品名称");
		// 	$("[name='name']").focus();
		// 	return false;
		// }
		
		
		
		//商品价格
		var reg1 = /^[0-9]{0,9}[\.][0-9]{1,2}$/;
	    var reg2 = /^[0-9]{0,9}$/;
	    var price=$("[name='price']").val();

	    
		
		return true;
	}

    </script>
